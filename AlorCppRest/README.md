# C++ API client

API для работы с торговой системой АЛОР Брокер. Предоставляет интерфейсы для выставления заявок и получения биржевой информации.

Данные для неавторизованных запросов предоставляются с задержкой от 15 минут, для авторизованных - без задержек. 

Публичная биржевая информация может быть получена через HTTP(S) API, а также доступна через однократно установленное WebSocket соединение. <br>
**Внимание!** WebSocket соединения могут и будут разрываться *(например, если клиент не успевает обрабатывать сообщения и на стороне API в буфере накопится более 5000 событий)*. <br>
Во внешнем ПО необходимо предусмотреть механизмы переподключения и переподписки (при необходимости)! <br> <br> 
В OpenAPI V2 доступны \"Московская Биржа\" (MOEX) и \"Биржа СПБ\" (SPBX). 

<h4> Доступные типы данных </h4>
 * Все сделки
 * Все заявки
 * Информация по инструментам
 * Котировки
 * Биржевые стаканы
 * Исторические данные
 * Позиции
 * Информация о клиенте

<h4>Поддерживаемые виды заявок</h4>
 * рыночные
 * лимитные
 * стоп-лосс
 * тейк-профит
 * стоп-лосс лимит
 * тейк-профит лимит

<h4>    Ограничения по частоте запросов     </h4>
<p>На текущий момент ограничений по количеству запросов в минуту нет, однако есть ограничение на общее количество подписок (сотни тысяч). При достижении лимита подписок клиент будет заблокирован и в течение нескольких минут не сможет создавать новые подписки. Уже существующие подписки продолжат работать. <br/>
 Сервер может обрабатывать \"тяжелые\" запросы (пример - история за все время) и запросы без авторизации с меньшим приоритетом.<br/>
</p>

<h4>Получение списка портфелей</h4>
<p>Получить список доступных портфелей можно из JWT токена</p>
<p>Для получения списка доступных портфелей необходимо декодировать JWT токен. Портфели находятся в поле <b>portfolios</b>.</p>
<br/>

<h2>
Авторизация
</h2>

<h4>OAuth</h4>

<b>Внимание!</b>  
JWT и refresh token — равносильны логину и паролю.
Их нужно скрывать от публичного доступа.

<h4>Для разработчиков сторонних приложений, в которых торговлю будут вести их пользователи.</h4>

Мы предоставляем сервис для авторизации сторониих приложений по стандарту OAuth 2.0.
С примером приложения, использующего OAuth сервис для авторизации пользователей можно ознакомиться в разделе
 <a href=\"/examples\">Примеры</a>.

Список разрешений (scopes), которые могут быть выданы приложению:
<table>
  <tr>
    <td><b>OrdersRead</b></td>
    <td>Чтение выставленных заявок</td>
  </tr>
  <tr>
    <td><b>OrdersCreate</b></td>
    <td>Выставление заявок</td>
  </tr>
  <tr>
    <td><b>Trades</b></td>
    <td>Чтение совершенных сделок</td>
  </tr>
  <tr>
    <td><b>Personal</b></td>
    <td>Персональная информация: ФИО, почта и т.п.</td>
  </tr>
  <tr>
    <td><b>Stats</b></td>
    <td>Статистика: прибыль, средние цены и т.п.</td>
  </tr>
</table>

<h4>Для ведения операций от своего имени</h4>

Выписать себе <b>refresh token</b> для ведения операций от своего имени [можно здесь](https://alor.dev/open-api-tokens).

<h2>Краткое описание работы с авторизацией</h2>

Чтобы выполнить авторизованный запрос, добавьте в запрос заголовок с именем \"Authorization\"
и значением, состоящим из префикса `\"Bearer \"` и валидного JWT токена.

Срок жизни JWT короткий: это сделано для безопасности. 
Для большинства вариантов использования API мы рекоммендуем использовать механизм  <b>refresh token</b> .

Механизм  <b>refresh token</b>  позволяет получать JWT с новым сроком жизни.
Для этого отправьте POST запрос на адрес `https://oauthdev.alor.ru/refresh?token={refreshToken}` *(тестовый контур)* или `https://oauth.alor.ru/refresh?token={refreshToken}` *(боевой контур)*.
Если у  <b>refresh token</b>  не истек срок жизни и не он не был отозван, то в теле ответа в поле AccessToken вернётся свежий JWT токен. 

Срок жизни  <b>refresh token</b>, получаемого обычным способом — 1 месяц.  
Срок жизни  <b>refresh token</b>, получаемого самостоятельным выписыванием — год.

|
|-

> Если мы для вас не завели портфели для ведения торговли в игровом контуре, оставьте заявку на <a href=\"mailto:openapi@alor.ru\">openapi@alor.ru</a> или свяжитесь с нами в [телеграме](https://t.me/AlorOpenAPI).

</br></br>
Тестовый контур: `https://apidev.alor.ru`

Боевой контур: `https://api.alor.ru`


## Overview
This API client was generated by the [OpenAPI Generator](https://openapi-generator.tech) project. By using the [OpenAPI spec](https://openapis.org) from a remote server, you can easily generate an API client.

- API version: 1.0
- Package version: 
- Build package: org.openapitools.codegen.languages.CppRestSdkClientCodegen

- API namespace: alorapi
- Model namespace: alormodel

## Installation

### Prerequisites

Install [cpprestsdk](https://github.com/Microsoft/cpprestsdk).

- Windows: `vcpkg install cpprestsdk cpprestsdk:x64-windows boost-uuid boost-uuid:x64-windows`
- Mac: `brew install cpprestsdk`
- Linux: `sudo apt-get install libcpprest-dev`

### Build

```sh
cmake -DCPPREST_ROOT=/usr -DCMAKE_CXX_FLAGS="-I/usr/local/opt/openssl/include" -DCMAKE_MODULE_LINKER_FLAGS="-L/usr/local/opt/openssl/lib"
make
```

### Build on Windows with Visual Studio (VS2017)

- Right click on folder containing source code
- Select 'Open in visual studio'
- Once visual studio opens, CMake should show up in top menu bar.
- Select CMake > Build All.

*Note: If the CMake menu item doesn't show up in Visual Studio, CMake
for Visual Studio must be installed. In this case, open the 'Visual Studio
Installer' application. Select 'modify' Visual Studio 2017. Make sure
'Desktop Development with C++' is installed, and specifically that 'Visual
C++ tools for CMake' is selected in the 'Installation Details' section.

Also be sure to review the CMakeLists.txt file. Edits are likely required.*

## Author

openapi@alor.ru

